{"results": {"content_files": {"name": "README.rst", "path": "README.rst", "content": "===============\nGetting Started\n===============\n\n.. image:: https://img.shields.io/pypi/v/gspread-pandas.svg\n        :target: https://pypi.python.org/pypi/gspread-pandas\n        :alt: PyPI Version\n\n.. image:: https://img.shields.io/travis/aiguofer/gspread-pandas.svg\n        :target: https://travis-ci.org/aiguofer/gspread-pandas\n        :alt: Travis-CI Build Status\n\n.. image:: https://readthedocs.org/projects/gspread-pandas/badge/?version=latest\n        :target: https://gspread-pandas.readthedocs.io/en/latest/?badge=latest\n        :alt: Documentation Status\n\nauthor: Diego Fernandez\n\nLinks:\n\n-  `Documentation <http://gspread-pandas.readthedocs.io/>`_\n-  `Source code <https://github.com/aiguofer/gspread-pandas>`_\n-  `Short video tutorial <https://youtu.be/2yIcNYzfzPw>`_\n\n.. attention:: Upgrading from < 2.0\n\n    If you are upgrading, the ``user`` is now an optional param that\n    uses ``default`` as the default. If you're a single user, you might\n    want to re-name your credentials to ``default`` so you can stop\n    specifying it:\n\n    .. code-block:: console\n\n        mv ~/.config/gspread_pandas/creds{<old_name>,default}\n\nOverview\n========\n\nA package to easily open an instance of a Google spreadsheet and\ninteract with worksheets through Pandas DataFrames. It enables you to\neasily pull data from Google spreadsheets into DataFrames as well as\npush data into spreadsheets from DataFrames. It leverages\n`gspread <https://github.com/burnash/gspread/>`__ in the backend for\nmost of the heavylifting, but it has a lot of added functionality\nto handle things specific to working with DataFrames as well as\nsome extra nice to have features.\n\nThe target audience are Data Analysts and Data Scientists, but it can also\nbe used by Data Engineers or anyone trying to automate workflows with Google\nSheets and Pandas.\n\nSome key goals/features:\n\n-  Be easy to use interactively, with good docstrings and auto-completion\n-  Nicely handle headers and indexes (including multi-level headers and merged cells)\n-  Run on Jupyter, headless server, and/or scripts\n-  Allow storing different user credentials or using Service Accounts\n-  Automatically handle token refreshes\n-  Enable handling of frozen rows and columns\n-  Enable filling in all merged cells when pulling data\n-  Nicely handle large data sets and auto-retries\n-  Enable creation of filters\n-  Handle retries when exceeding 100 second user quota\n-  When pushing DataFrames with MultiIndex columns, allow merging or flattening headers\n-  Ability to handle Spreadsheet permissions\n-  Ability to specify ``ValueInputOption`` and ``ValueRenderOption`` for specific columns\n\nInstallation / Usage\n====================\n\nTo install use pip:\n\n.. code-block:: console\n\n    $ pip install gspread-pandas\n\nOr clone the repo:\n\n.. code-block:: console\n\n    $ git clone https://github.com/aiguofer/gspread-pandas.git\n    $ python setup.py install\n\nBefore using, you will need to download Google client credentials for\nyour app.\n\nClient Credentials\n------------------\n\nTo allow a script to use Google Drive API we need to authenticate our\nself towards Google. To do so, we need to create a project, describing\nthe tool and generate credentials. Please use your web browser and go to\n`Google console <https://console.developers.google.com/>`__ and :\n\n-  Choose **Create Project** in popup menu on the top.\n-  A dialog box appears, so give your project a name and click on\n   **Create** button.\n-  On the left-side menu click on **API Manager**.\n-  A table of available APIs is shown. Switch **Drive API** and click on\n   **Enable API** button. Do the same for **Sheets API**. Other APIs might\n   be switched off, for our purpose.\n-  On the left-side menu click on **Credentials**.\n-  In section **OAuth consent screen** select your email address and\n   give your product a name. Then click on **Save** button.\n-  In section **Credentials** click on **Add credentials** and switch\n   **OAuth client ID** (if you want to use your own account or enable\n   the use of multiple accounts) or **Service account key** (if you prefer\n   to have a service account interacting with spreadsheets).\n-  If you select **OAuth client ID**:\n\n   -  Select **Application type** item as **Other** and give it a name.\n   -  Click on **Create** button.\n   -  Click on **Download JSON** icon on the right side of created\n      **OAuth client IDs** and store the downloaded file on your file system.\n-  If you select **Service account key**\n\n   -  Click on **Service account** dropdown and select **New service account**\n   -  Give it a **Service account name** and ignore the **Role** dropdown\n      (unless you know you need this for something else, it's not necessary for\n      working with spreadsheets)\n   -  Note the **Service account ID** as you might need to give that user\n      permission to interact with your spreadsheets\n   -  Leave **Key type** as **JSON**\n   -  Click **Create** and store the downloaded file on your file system.\n-  Please be aware, the file contains your private credentials, so take\n   care of the file in the same way you care of your private SSH key;\n   Move the downloaded JSON to ``~/.config/gspread_pandas/google_secret.json``\n   (or you can configure the directory and file name by directly calling\n   ``gspread_pandas.conf.get_config``\n\n\nThanks to similar project\n`df2gspread <https://github.com/maybelinot/df2gspread>`__ for this great\ndescription of how to get the client credentials.\n\nYou can read more about it in the `configuration docs\n<https://gspread-pandas.readthedocs.io/en/latest/configuration.html>`__\nincluding how to change the default behavior.\n\nExample\n=======\n\n.. code:: python\n\n    from __future__ import print_function\n    import pandas as pd\n    from gspread_pandas import Spread, Client\n\n    file_name = \"http://stats.idre.ucla.edu/stat/data/binary.csv\"\n    df = pd.read_csv(file_name)\n\n    # 'Example Spreadsheet' needs to already exist and your user must have access to it\n    spread = Spread('Example Spreadsheet')\n    # This will ask to authenticate if you haven't done so before\n\n    # Display available worksheets\n    spread.sheets\n\n    # Save DataFrame to worksheet 'New Test Sheet', create it first if it doesn't exist\n    spread.df_to_sheet(df, index=False, sheet='New Test Sheet', start='A2', replace=True)\n    spread.update_cells('A1', 'A1', ['Created by:', spread.email])\n    print(spread)\n    # <gspread_pandas.client.Spread - User: '<example_user>@gmail.com', Spread: 'Example Spreadsheet', Sheet: 'New Test Sheet'>\n\n    # You can now first instanciate a Client separately and query folders and\n    # instanciate other Spread objects by passing in the Client\n    client = Client()\n    # Assumming you have a dir called 'example dir' with sheets in it\n    available_sheets = client.find_spreadsheet_files_in_folders('example dir')\n    spreads = []\n    for sheet in available_sheets.get('example dir', []):\n        spreads.append(Spread(sheet['id'], client=client))\n\nTroubleshooting\n===============\n\nSSL Error\n---------\n\nIf you're getting an SSL related error or can't seem to be able to open existing\nspreadsheets that you have access to, you might be running into an issue caused by\n``certifi``. This has mainly been experienced on RHEL and CentOS running Python 2.7.\nYou can read more about it in `issue 223\n<https://github.com/burnash/gspread/issues/223>`_\nand `issue 354 <https://github.com/burnash/gspread/issues/354>`_ but, in short, the\nsolution is to either install a specific version of ``certifi`` that works for you,\nor remove it altogether.\n\n.. code-block:: console\n\n   pip install certifi==2015.4.28\n\nor\n\n.. code-block:: console\n\n   pip uninstall certifi\n\nEOFError in Rodeo\n-----------------\n\nIf you're trying to use ``gspread_pandas`` from within\n`Rodeo <https://www.yhat.com/products/rodeo>`_ you might get an\n``EOFError: EOF when reading a line`` error when trying to pass in the verification\ncode. The workaround for this is to first verify your account in a regular shell.\nSince you're just doing this to get your Oauth token, the spreadsheet doesn't need\nto be valid. Just run this in shell:\n\n.. code:: python\n\n   python -c \"from gspread_pandas import Spread; Spread('<user_key>','')\"\n\nThen follow the instructions to create and store the OAuth creds.\n"}}}